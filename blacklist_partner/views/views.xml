<odoo>
  <data>

        <!-- Action for Blacklisted Partners -->
        <record id="action_blacklisted_partners" model="ir.actions.act_window">
            <field name="name">Contact blacklistés</field>
            <field name="type">ir.actions.act_window</field>
            <field name="res_model">res.partner</field>
            <field name="view_mode">tree,form,kanban</field>
            <field name="domain">[('is_blacklisted', '=', True)]</field>
            <field name="context">{'default_is_blacklisted': True}</field>
            <field name="help" type="html">
                <p class="o_view_nocontent_smiling_face">
                    Aucun contact blacklisté trouvé
                </p>
                <p>
                    Les contacts blacklistés apparaissent ici
                </p>
            </field>
        </record>

        <!-- Special Tree View for Blacklisted Partners -->
        <record id="view_blacklisted_partner_tree" model="ir.ui.view">
            <field name="name">blacklisted.partner.tree</field>
            <field name="model">res.partner</field>
            <field name="arch" type="xml">
                <tree string="Blacklisted Partners" decoration-danger="is_blacklisted">
                    <field name="name"/>
                    <field name="phone"/>
                    <field name="email"/>
                    <field name="city"/>
                    <field name="country_id"/>
                    <field name="is_blacklisted"/>
                    <field name="create_date"/>
                </tree>
            </field>
        </record>

    <!-- Inherit Partner Form View -->
    <record id="view_partner_form_inherit_blacklist" model="ir.ui.view">
      <field name="name">res.partner.form.inherit.blacklist</field>
      <field name="model">res.partner</field>
      <field name="inherit_id" ref="base.view_partner_form"/>
      <field name="arch" type="xml">
        <!-- Add warning message -->
        <xpath expr="//sheet" position="before">
          <div class="alert alert-danger" role="alert" 
               attrs="{'invisible': [('is_blacklisted', '=', False)]}"
               groups="blacklist_partner.group_blacklist_user">
            <strong>Attention: Ce contact a été blacklisté!</strong>
          </div>
        </xpath>
        
        <!-- Add blacklist field -->
        <xpath expr="//field[@name='vat']" position="after">
          <field name="is_blacklisted" 
                 readonly="1" 
                 groups="blacklist_partner.group_blacklist_user"/>
        </xpath>
        
        <!-- Add blacklist buttons -->
        <xpath expr="//div[hasclass('oe_button_box')]" position="inside">
          <button name="action_blacklist_partner" 
                  type="object"
                  class="oe_stat_button"
                  attrs="{'invisible': [('is_blacklisted', '=', True)]}"
                  groups="blacklist_partner.group_blacklist_manager">
            <div class="o_stat_info">
              <span class="fa fa-ban"/>
              <span class="o_stat_text text-danger">Blacklister</span>
            </div>
          </button>
          <button name="action_unblacklist_partner" 
                  type="object"
                  class="oe_stat_button"
                  attrs="{'invisible': [('is_blacklisted', '=', False)]}"
                  groups="blacklist_partner.group_blacklist_manager">
            <div class="o_stat_info">
              <span class="fa fa-check"/>
              <span class="o_stat_text text-success">Retirer de la Blacklist</span>
            </div>
          </button>
        </xpath>
      </field>
    </record>

    <!-- Search View -->
    <record id="view_res_partner_filter_inherit_blacklist" model="ir.ui.view">
      <field name="name">res.partner.select.inherit.blacklist</field>
      <field name="model">res.partner</field>
      <field name="inherit_id" ref="base.view_res_partner_filter"/>
      <field name="arch" type="xml">
        <filter name="type_company" position="after">
          <filter string="Blacklisted" 
                  name="blacklisté"
                  domain="[('is_blacklisted', '=', True)]"
                  groups="blacklist_partner.group_blacklist_user"/>
        </filter>
      </field>
    </record>

    <!-- Menu Items -->
        <!-- Parent Menu -->
        <menuitem id="menu_blacklist_root"
                  name="Blacklist"
                  parent="contacts.menu_contacts"
                  sequence="10"
                  groups="blacklist_partner.group_blacklist_manager"/>

        <!-- Blacklisted Partners Menu -->
        <menuitem id="menu_blacklisted_partners"
                  name="Contacts de la blacklist"
                  parent="menu_blacklist_root"
                  action="action_blacklisted_partners"
                  sequence="1"
                  groups="blacklist_partner.group_blacklist_manager"/>
  </data>
</odoo>